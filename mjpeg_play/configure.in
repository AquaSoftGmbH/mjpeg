dnl Process this file with autoconf to produce a configure script.
AC_INIT(lav_io.c)

AM_INIT_AUTOMAKE(lavtools, 0.1.0)
AM_MAINTAINER_MODE

dnl Checks for programs.
AC_PROG_CC
AC_PROG_RANLIB

AC_SUBST(JPEG)
JPEG=""
if test "$enable_jpeg" != "no"; then
    AC_CHECK_LIB(jpeg, jpeg_start_compress,JPEG="-ljpeg" have_jpeg="yes",,)
else
    echo "*** jpeg disabled"
fi

dnl ---------------------------------------------------------------------       
dnl X11 checks                                                                                                                                                  
AC_PATH_XTRA                                                                    
if test "-DX_DISPLAY_MISSING" = "$X_CFLAGS"; then                                 
AC_MSG_ERROR(can not find X11)                                                
fi                                                                              
AC_SUBST(X_CFLAGS)                                                              
AC_SUBST(X_PRE_LIBS)                                                            
AC_SUBST(X_EXTRA_LIBS)                                                          
AC_SUBST(X_LIBS)                                                                
AC_SUBST(x_libraries)                                                           

dnl Checks for header files.
dnl AC_HEADER_STDC
dnl AC_CHECK_HEADERS(fcntl.h unistd.h)

dnl Checks for typedefs, structures, and compiler characteristics.
AC_C_CONST
AC_C_INLINE
AC_TYPE_SIZE_T

dnl Checks for library functions.
AC_TYPE_SIGNAL

dnl Check for GLib
AM_PATH_GLIB(1.2.0)
AC_SUBST(GLIB_CFLAGS)
AC_SUBST(GLIB_LIBS)

AC_SUBST(SDL)
dnl Check for SDL
AM_PATH_SDL(1.1.3, have_SDL="yes" SDL="-lSDL -lpthread")

if test "$have_jpeg" = "yes"; then
if test "$have_SDL" = "yes"; then
    build_MJPEG="yes"
    AC_DEFINE(BUILD_MJPEG)
else
    echo "*** Software MJPEG won't be build (SDL not available)"
    build_MJPEG="no"
fi
else
    echo "*** Software MJPEG won't be build (JPEG not available)"
    build_MJPEG="no"
fi


AC_SUBST(build_MJPEG)
AC_OUTPUT(Makefile
	movtar/Makefile
	mjpeg/Makefile)

echo ""
echo " lavtools ${VERSION} build configuration :"
echo ""
echo "    - software MJPEG playback     : ${build_MJPEG}"
echo ""












